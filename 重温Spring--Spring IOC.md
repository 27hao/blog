---
title: 重温Spring--Spring IOC
categories: Spring
date: 2019-03-14 17:09:43
---
### 什么是IOC, 与DI是什么关系？
控制反转（Inversion of Control，缩写为IoC），是面向对象编程中的一种设计原则，可以用来减低计算机代码之间的耦合度。其中最常见的方式，也是Spring实现IOC的方式，叫做依赖注入（Dependency Injection，简称DI），还有一种方式叫“依赖查找”（Dependency Lookup）。

### 怎么理解依赖注入（DI）
依赖：Class A 里有一个属性 Interface B, 则就说明 A 依赖 B.
注入：容器将 A 的 B 属性设置为 B 的具体实现则称为注入。

### 为什么要用IOC
在软件开发中，我们为了解耦（降低模块与模块，类与类之间的联系或者说依赖程度），其中一个思想是面向抽象编程，我们只依赖一个抽象的描述，而不是具体实现，所以我们把具体实现的对象交给 Spring 管理，类里面只依赖一个抽象的声明，当具体实现改变或者需要增强时，例如增加事务或者日志，然后 Spring 只需要把增强的实现再给使用方，而不需要更改原有代码，实现开闭原则，更易维护。

### Spring 实现 IOC 的思路和方法
1. 应用程序中提供类，提供依赖关系（属性或者构造方法）
2. 把需要交给容器管理的对象通过配置信息告诉容器（xml、annotation，javaconfig）
3. 把各个类之间的依赖关系通过配置信息告诉容器

### Spring 提供信息描述的方式
1. XML文件配置
2. Java Config
3. 注解 Annotation (依赖于其它两种方式)

### Spring 提供注入的方式
1. 构造方法注入
2. set 方法注入
3. 方法注入（解决单例依赖多例的方法）


### 自动注入
从 Spring 的 IOC 实现方式可以看出，其实我们在配置的时候多做了一步，就是描述类与类之间的依赖关系，因为在 Java 代码中我们已经给出了依赖关系；而不需要给容器描述依赖关系则叫自动注入。
在使用 XML 文件配置自动注入的时候，set 方法 byName 注入的时候是按照方法名注入;而使用注解 @Autowire 默认使用 byType注入，如果有多个实现的时候使用 byName注入，这时候是按照属性名注入。

### Spring Bean 的作用域
Singleton: 单例
Prototype: 多例

### Spring 解决循环依赖
当 Bean 是单例时，可以实现循环依赖，因为 Spring 容器在启动的时候就会把所有单例对象 new 出来放到容器中，然后再一个一个注入各个对象的依赖对象，所以可以解决循环依赖；但是如果 Bean 都是是多例时，由于程序在调用这个 Bean 的时候 Spring 才会去 new 对象，所依赖的 Bean 还没有在容器中，注入就会失败，也就不能解决循环依赖问题。
